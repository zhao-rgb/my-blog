<template>
	<div class="writearticle border">
		<div class="container">
			<div class="row">
				<link href="https://fonts.googleapis.com/css?family=Cabin+Sketch:700&display=swap" rel="stylesheet" />
				<div class="zh-col-6">
					<div class="text-effect">
						<span>M</span>
						<span>e</span>
						<span>r</span>
						<span>r</span>
						<span>y</span>
					</div>
					<div class="text-effect">
						<span>C</span>
						<span>h</span>
						<span>r</span>
						<span>i</span>
						<span>s</span>
						<span>t</span>
						<span>m</span>
						<span>a</span>
						<span>s</span>
						<span>!</span>
					</div>

					<div class="emoji-container">
						<!--icon #1-->
						<div class="icon">
							<div class="frog" id="frog-1">
								<div class="body"><div class="mouth"></div></div>

								<div class="eyes">
									<div class="eye eye-left">
										<div class="eye-inner">
											<div class="pupil"><div class="light"></div></div>
										</div>
									</div>
									<div class="eye eye-right">
										<div class="eye-inner">
											<div class="pupil"><div class="light"></div></div>
										</div>
									</div>
								</div>
							</div>
						</div>

						<!--icon #2-->
						<div class="icon">
							<div class="frog" id="frog-2">
								<div class="body">
									<div class="blush"></div>
									<div class="mouth big-mouth"></div>
								</div>

								<div class="eyes">
									<div class="eye eye-left">
										<div class="eye-inner">
											<div class="pupil"><div class="light"></div></div>
										</div>
									</div>
									<div class="eye eye-right">
										<div class="eye-inner">
											<div class="pupil"><div class="light"></div></div>
										</div>
									</div>
								</div>
							</div>
						</div>

						<!--icon #3-->
						<div class="icon">
							<div class="frog" id="frog-3">
								<div class="body">
									<div class="mouth"><div class="toungue"></div></div>
								</div>

								<div class="eyes">
									<div class="eye eye-left wink">
										<div class="eye-inner">
											<div class="pupil"><div class="light"></div></div>
										</div>
									</div>
									<div class="eye eye-right">
										<div class="eye-inner">
											<div class="pupil"><div class="light"></div></div>
										</div>
									</div>
								</div>
							</div>
						</div>

						<!--icon #4-->
						<div class="icon">
							<div class="frog" id="frog-4">
								<div class="body">
									<div class="mouth big-mouth"><div class="toungue"></div></div>
								</div>

								<div class="eyes">
									<div class="eye eye-left extra-light">
										<div class="eye-inner">
											<div class="pupil"><div class="light"></div></div>
										</div>
									</div>
									<div class="eye eye-right extra-light">
										<div class="eye-inner">
											<div class="pupil"><div class="light"></div></div>
										</div>
									</div>
								</div>
							</div>
						</div>

						<!--icon #5-->
						<div class="icon">
							<div class="frog" id="frog-5">
								<div class="body">
									<div class="blush"></div>
									<div class="mouth"></div>
								</div>

								<div class="eyes">
									<div class="eye eye-left">
										<div class="eye-inner">
											<div class="pupil"><div class="light"></div></div>
										</div>
									</div>
									<div class="eye eye-right">
										<div class="eye-inner">
											<div class="pupil"><div class="light"></div></div>
										</div>
									</div>
								</div>
							</div>
						</div>

						<!--icon #6-->
						<div class="icon">
							<div class="frog" id="frog-6">
								<div class="body">
									<div class="blush"></div>
									<div class="mouth"></div>
								</div>

								<div class="eyes">
									<div class="eye eye-left extra-light">
										<div class="eye-inner">
											<div class="pupil"><div class="light"></div></div>
										</div>
									</div>
									<div class="eye eye-right extra-light">
										<div class="eye-inner">
											<div class="pupil"><div class="light"></div></div>
										</div>
									</div>
								</div>
							</div>
						</div>

						<!--icon #7-->
						<div class="icon">
							<div class="frog" id="frog-7">
								<div class="body"><div class="mouth"></div></div>

								<div class="eyes">
									<div class="eye eye-left">
										<div class="eye-inner">
											<div class="pupil"><div class="light"></div></div>
										</div>
									</div>
									<div class="eye eye-right">
										<div class="eye-inner">
											<div class="pupil"><div class="light"></div></div>
										</div>
									</div>
								</div>
							</div>
						</div>

						<!--icon #8-->
						<div class="icon">
							<div class="frog" id="frog-8">
								<div class="body">
									<div class="mouth"></div>
									<div class="sleepy-icons">
										<div>Z</div>
										<div>Z</div>
										<div>Z</div>
									</div>
								</div>

								<div class="eyes">
									<div class="eye eye-left">
										<div class="eye-inner">
											<div class="pupil"><div class="light"></div></div>
										</div>
									</div>
									<div class="eye eye-right">
										<div class="eye-inner">
											<div class="pupil"><div class="light"></div></div>
										</div>
									</div>
								</div>
							</div>
						</div>

						<!--icon #9-->
						<div class="icon">
							<div class="frog" id="frog-9">
								<div class="body">
									<div class="blush"></div>
									<div class="mouth"></div>
								</div>

								<div class="eyes">
									<div class="eye eye-left">
										<div class="eye-inner">
											<div class="pupil"><div class="light"></div></div>
										</div>
									</div>
									<div class="eye eye-right">
										<div class="eye-inner">
											<div class="pupil"><div class="light"></div></div>
										</div>
									</div>
								</div>
							</div>
						</div>

						<!--icon #10-->
						<div class="icon">
							<div class="frog" id="frog-10">
								<div class="body"><div class="mouth"></div></div>

								<div class="eyes">
									<div class="eye eye-left">
										<div class="eye-inner">
											<div class="pupil"><div class="light"></div></div>
										</div>
									</div>
									<div class="eye eye-right">
										<div class="eye-inner">
											<div class="pupil"><div class="light"></div></div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class="zh-col-6">
					<div class="c">
						<span style="color: black;">作者ID: {{ this.user.id }}</span>
						<div class="con">
							<div class="con-head">
								<input type="text" placeholder="标题:" v-model="writeArticle.title" />
								<input type="text" placeholder="简介:" v-model="writeArticle.content" />
								<input type="text" placeholder="专题ID:" v-model="writeArticle.topicId" />
							</div>
							<div class="con-body">
								<textarea rows="10" cols="30" placeholder="内容:" v-model="writeArticle.text"></textarea>
								<h3>选择图片</h3>
								<div class="preview-box">
									<i class="iconfont">&#xe603;</i>
									<input type="file" @change="changeAvatar($event)" class="select-file" />
								</div>
								<button v-on:click="release()">发布</button>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</template>

<script>
export default {
	data() {
		return {
			user: JSON.parse(localStorage.getItem('user')),
			userVo: {
				user: {},
				articleList: {}
			},
			writeArticle: {
				topicId: '',
				userId: '',
				title: '',
				content: '',
				cover: '',
				diamond: 0,
				comments: 0,
				likes: 0,
				text: ''
			}
		};
	},
	created() {
		var query = window.location.href;
		//锁定到最后一个"/"的位置
		var begin = query.lastIndexOf('/') + 1;
		//取出地址中最后的id值
		var usersId = query.substring(begin);
		this.axios.get(this.GLOBAL.baseUrl + '/detail/' + usersId).then(res => {
			console.log(res.data.data);
			this.userVo = res.data.data;
		});
	},
	methods: {
		getImages(_url) {
			if (_url) {
				let _u = _url.substring(8);
				return 'https://images.weserv.nl/?url=' + _u;
			}
		},
		changeAvatar: function() {
			var _this = this;
			let formData = new FormData();
			alert(event.target.files[0].name);
			formData.append('file', event.target.files[0]);
			this.$http({
				method: 'post',
				url: this.GLOBAL.baseUrl + '/upload',
				headers: {
					'Content-Type': 'multipart/form-data'
				},
				data: formData,
				processData: false,
				contentType: false
			}).then(uploadFileRes => {
				console.log(uploadFileRes.data.data);
				_this.cover = uploadFileRes.data.data;
				this.release(_this.cover);
			});
		},
		release(cover) {
			if (this.writeArticle.text == '' || this.writeArticle.text == '' || this.writeArticle.content == '' || this.writeArticle.topicId == '') {
				alert('类容不能为空');
				return;
			}
			this.writeArticle.userId = this.user.id;
			this.writeArticle.cover = cover;
			alert(cover);
			this.axios.post(this.GLOBAL.baseUrl + '/article/new', this.writeArticle).then(res => {
				this.user.articles++;
			});
			alert('发布成功');
			this.$router.push('/user/person/' + this.user.id);
			this.$router.go(0);
		}
	}
};
</script>
<style>
.text-effect {
	color: #ffff00;
	font-family: 'Cabin Sketch', cursive;
	font-size: 100px;
	text-align: center;
	text-transform: uppercase;
	margin: 0 auto;
	position: relative;
}
.text-effect span {
	display: inline-block;
	animation: animate 0.5s linear infinite both;
}
.text-effect span:nth-child(1),
.text-effect span:nth-child(4),
.text-effect span:nth-child(7),
.text-effect span:nth-child(10),
.text-effect span:nth-child(14) {
	color: #4cd137;
}
.text-effect span:nth-child(2),
.text-effect span:nth-child(5),
.text-effect span:nth-child(8),
.text-effect span:nth-child(12) {
	color: #ff0000;
}
@keyframes animate {
	0%,
	50%,
	100% {
		transform: rotate(0deg) scale(1);
	}
	25% {
		transform: rotate(4deg) scale(0.98);
	}
	75% {
		transform: rotate(-4deg) scale(1.02);
	}
}
@media only screen and (max-width: 990px) {
	.text-effect {
		font-size: 100px;
	}
}
@media only screen and (max-width: 767px) {
	.text-effect {
		font-size: 80px;
	}
}
@media only screen and (max-width: 479px) {
	.text-effect {
		font-size: 60px;
	}
}
@media only screen and (max-width: 359px) {
	.text-effect {
		font-size: 45px;
	}
}

.preview-box {
	width: 100px;
	height: 100px;
	border: 1px dashed #aaa;
	position: relative;
	margin: 10px;
}
.preview-box .iconfont {
	position: absolute;
	top: 0;
	left: 0;
	width: 100%;
	height: 100%;
	font-size: 100px;
}
.select-file {
	position: absolute;
	top: 0;
	left: 0;
	height: 100%;
	width: 100%;
	opacity: 0;
	z-index: 9999;
	cursor: pointer;
}
.writearticle {
	background-color: rgb(241, 248, 233);
	width: 100%;
	height: 800px;
}
.c {
	margin-top: 40px;
}
.con .con-head {
	display: flex;
	flex-direction: column;
	margin-bottom: 20px;
}
.con .con-head input {
	width: 500px;
	height: 40px;
	margin-top: 20px;
}
.con .con-body {
	width: 500px;
	height: 40px;
	margin-top: 20px;
}
.con .con-body textarea {
	width: 750px;
	height: 100px;
	margin-top: 30px;
	margin-bottom: 30px;
}
.con .con-body button {
	width: 100px;
	height: 40px;
	background-color: orange;
}

.emoji-container {
	color: #d5d6e2;
	font-weight: 500;
	font-size: 1.05em;
	font-family: 'Microsoft YaHei', 'Segoe UI', 'Lucida Grande', Helvetica, Arial, sans-serif;
	text-align: center;
	box-sizing: border-box;
	padding: 0px;
	margin: 50px;
	display: flex;
	justify-items: center;
	-webkit-box-align: start;
	align-items: flex-start;
	flex-wrap: wrap;
}
</style>
